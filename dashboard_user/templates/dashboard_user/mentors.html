{% extends "dashboard_user/base.html" %}
{% load static %}

{% block page_title %}Your Mentors{% endblock %}

{% block dashboard_content %}
<div class="mentors-page">
  <div class="mentors-header">
    <h1>Your Mentors</h1>
    <a href="{% url 'web:mentors' %}" class="btn-find-new-mentor">
      <i class="fas fa-search"></i> Find a New Mentor
    </a>
  </div>

  <div class="mentors-container">
    {% if relationships %}
      <div class="mentors-list">
        <!-- Table Header (Hidden on Mobile) -->
        <div class="mentors-list-header">
          <div class="col-mentor">Mentor</div>
          <div class="col-email">Email</div>
          <div class="col-status">Status</div>
          <div class="col-sessions">Sessions</div>
          <div class="col-actions"></div>
        </div>

        <!-- List Body -->
        <div class="mentors-list-body">
          {% for relationship in relationships %}
            <div class="mentor-entry {% if relationship.status == 'inactive' and not relationship.confirmed %}is-pending{% endif %}">
              <!-- Name & Avatar -->
              <div class="entry-col col-mentor">
                <div class="mentor-profile-group">
                  {% if relationship.mentor.profile_picture %}
                    <img src="{{ relationship.mentor.profile_picture.url }}" alt="{{ relationship.mentor.first_name }}" class="entry-avatar">
                  {% else %}
                    <div class="entry-avatar is-placeholder">
                      <i class="fas fa-user"></i>
                    </div>
                  {% endif %}
                  <div class="entry-name-info">
                    {% if relationship.mentor.first_name or relationship.mentor.last_name %}
                      <a href="{% url 'web:mentor_profile_detail' relationship.mentor.user.id %}" class="entry-link">
                        {{ relationship.mentor.first_name }} {{ relationship.mentor.last_name }}
                      </a>
                    {% else %}
                      <span class="entry-empty">Not set</span>
                    {% endif %}
                    <span class="entry-label mobile-only">Mentor</span>
                  </div>
                </div>
              </div>

              <!-- Email -->
              <div class="entry-col col-email">
                <span class="entry-text">{{ relationship.mentor.user.email }}</span>
                <span class="entry-label mobile-only">Email</span>
              </div>

              <!-- Status -->
              <div class="entry-col col-status">
                <div class="status-badge-container">
                  {% if relationship.status == 'confirmed' and relationship.confirmed %}
                    <span class="badge badge-success"><i class="fas fa-check-circle"></i> Confirmed</span>
                  {% elif relationship.status == 'active' %}
                    <span class="badge badge-active"><i class="fas fa-play-circle"></i> Active</span>
                  {% elif relationship.status == 'inactive' and not relationship.confirmed %}
                    {% if relationship.mentor.user.is_email_verified %}
                      <span class="badge badge-warning"><i class="fas fa-clock"></i> Waiting</span>
                    {% else %}
                      <span class="badge badge-pending"><i class="fas fa-user-clock"></i> Pending</span>
                    {% endif %}
                  {% elif relationship.status == 'denied' %}
                    <span class="badge badge-danger"><i class="fas fa-times-circle"></i> Denied</span>
                  {% else %}
                    <span class="badge badge-default"><i class="fas fa-minus-circle"></i> Inactive</span>
                  {% endif %}
                </div>
                <span class="entry-label mobile-only">Status</span>
              </div>

              <!-- Sessions -->
              <div class="entry-col col-sessions">
                <div class="sessions-info">
                  <span class="sessions-val">{{ relationship.sessions_count }}</span>
                  <span class="sessions-txt">sessions</span>
                </div>
                <span class="entry-label mobile-only">Engagement</span>
              </div>

              <!-- Actions -->
              <div class="entry-col col-actions">
                <a href="{% url 'web:mentor_profile_detail' relationship.mentor.user.id %}" class="entry-btn">
                  View Profile <i class="fas fa-arrow-right"></i>
                </a>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    {% else %}
      <div class="no-mentors">
        <i class="fas fa-user-tie"></i>
        <p>No mentors yet</p>
        <a href="{% url 'web:mentors' %}" class="btn-find-mentor">
          <i class="fas fa-search"></i> Find a Mentor
        </a>
      </div>
    {% endif %}
  </div>
</div>

<style>
.mentors-page {
  padding: 32px;
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  box-sizing: border-box;
}

.mentors-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 32px;
  flex-wrap: wrap;
  gap: 16px;
}

.mentors-header h1 {
  font-size: 1.75rem;
  font-weight: 800;
  color: #1e293b;
  margin: 0;
  letter-spacing: -0.025em;
}

.mentors-container {
  width: 100%;
  /* Removed display: grid as requested */
}

.mentors-list {
  background: white;
  border-radius: 16px;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
  border: 1px solid #f1f5f9;
  overflow: hidden;
}

/* Desktop Header */
.mentors-list-header {
  display: grid;
  grid-template-columns: 1.5fr 1fr 1fr 0.8fr 180px;
  gap: 12px;
  padding: 16px 24px;
  background: #f8fafc;
  border-bottom: 1px solid #e2e8f0;
  font-weight: 700;
  font-size: 0.75rem;
  color: #64748b;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.mentor-entry {
  display: grid;
  grid-template-columns: 1.5fr 1fr 1fr 0.8fr 180px;
  gap: 12px;
  padding: 18px 24px;
  border-bottom: 1px solid #f1f5f9;
  align-items: center;
  transition: background 0.2s ease;
}

.mentor-entry:last-child {
  border-bottom: none;
}

.mentor-entry:hover {
  background: #fdfdfd;
}

.mentor-entry.is-pending {
  background: #fffbef;
}

/* Columns */
.entry-col {
  min-width: 0; /* Prevents overflow in flex/grid */
}

.mentor-profile-group {
  display: flex;
  align-items: center;
  gap: 12px;
}

.entry-avatar {
  width: 40px;
  height: 40px;
  border-radius: 10px;
  object-fit: cover;
  flex-shrink: 0;
  background: #f1f5f9;
  border: 1px solid #e2e8f0;
}

.is-placeholder {
  display: flex;
  align-items: center;
  justify-content: center;
  color: #94a3b8;
  font-size: 1rem;
}

.entry-name-info {
  display: flex;
  flex-direction: column;
  min-width: 0;
}

.entry-link {
  font-weight: 600;
  font-size: 0.95rem;
  color: #1e293b;
  text-decoration: none;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.entry-link:hover {
  color: #3b82f6;
}

.entry-empty {
  color: #94a3b8;
  font-style: italic;
  font-size: 0.85rem;
}

.entry-text {
  color: #64748b;
  font-size: 0.9rem;
  display: block;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Badges */
.badge {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 10px;
  border-radius: 20px;
  font-size: 0.75rem;
  font-weight: 600;
}

.badge-success { background: #ecfdf5; color: #065f46; border: 1px solid #d1fae5; }
.badge-active { background: #eff6ff; color: #1e40af; border: 1px solid #dbeafe; }
.badge-warning { background: #fff7ed; color: #9a3412; border: 1px solid #ffedd5; }
.badge-pending { background: #fefce8; color: #854d0e; border: 1px solid #fef9c3; }
.badge-danger { background: #fef2f2; color: #991b1b; border: 1px solid #fee2e2; }
.badge-default { background: #f8fafc; color: #475569; border: 1px solid #e2e8f0; }

/* Sessions */
.sessions-info {
  display: flex;
  align-items: baseline;
  gap: 4px;
}

.sessions-val {
  font-weight: 700;
  font-size: 1.05rem;
  color: #1e293b;
}

.sessions-txt {
  font-size: 0.7rem;
  color: #94a3b8;
  text-transform: uppercase;
  font-weight: 700;
}

/* Action Button */
.col-actions {
  display: flex;
  justify-content: flex-end;
}

.entry-btn {
  background: white;
  color: #334155;
  border: 1px solid #e2e8f0;
  padding: 8px 14px;
  border-radius: 8px;
  font-size: 0.8rem;
  font-weight: 600;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  transition: all 0.2s;
}

.entry-btn:hover {
  background: #f8fafc;
  border-color: #cbd5e1;
  transform: translateX(3px);
}

.entry-btn i {
  font-size: 0.7rem;
  color: #94a3b8;
}

/* Mobile Utilities */
.mobile-only {
  display: none;
}

/* Responsive Redesign */
@media (max-width: 992px) {
  .mentors-list-header {
    grid-template-columns: 1fr 1fr 1fr 80px 140px;
    padding: 12px 16px;
  }
  .mentor-entry {
    grid-template-columns: 1fr 1fr 1fr 80px 140px;
    padding: 16px;
  }
  .entry-btn {
    padding: 6px 10px;
    font-size: 0.75rem;
  }
}

@media (max-width: 768px) {
  .mentors-page {
    padding: 24px 16px;
  }
  
  .mentors-list-header {
    display: none;
  }
  
  .mentors-list {
    background: transparent;
    box-shadow: none;
    border: none;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }
  
  .mentor-entry {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    background: white;
    border-radius: 16px;
    padding: 24px;
    box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
    border: 1px solid #f1f5f9;
    gap: 20px;
  }
  
  .entry-col {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .entry-label {
    display: block;
    font-size: 0.7rem;
    font-weight: 700;
    text-transform: uppercase;
    color: #94a3b8;
    letter-spacing: 0.05em;
    order: 1;
  }
  
  .entry-col > *:not(.entry-label) {
    order: 2;
  }
  
  /* Feature specific mobile styles */
  .col-mentor {
    justify-content: center;
    border-bottom: 1px solid #f1f5f9;
    padding-bottom: 16px;
    margin-bottom: 4px;
  }
  
  .col-mentor .mentor-profile-group {
    flex-direction: column;
    text-align: center;
  }
  
  .col-mentor .entry-avatar {
    width: 64px;
    height: 64px;
    border-radius: 50%;
  }
  
  .col-mentor .entry-name-info {
    align-items: center;
    gap: 4px;
  }
  
  .col-mentor .entry-link {
    font-size: 1.1rem;
  }
  
  .col-mentor .mobile-only {
    display: none; /* Hide label for name because it's obvious */
  }
  
  .col-actions {
    justify-content: center;
    padding-top: 8px;
  }
  
  .entry-btn {
    width: 100%;
    justify-content: center;
    padding: 12px;
    font-size: 0.9rem;
    background: #f8fafc;
  }
}

/* Empty State Styling */
.no-mentors {
  text-align: center;
  padding: 80px 32px;
  background: white;
  border-radius: 20px;
  border: 2px dashed #e2e8f0;
}

.no-mentors i {
  font-size: 3.5rem;
  color: #e2e8f0;
  margin-bottom: 24px;
}

.no-mentors p {
  font-size: 1.1rem;
  font-weight: 600;
  color: #64748b;
  margin-bottom: 32px;
}

.btn-find-mentor, .btn-find-new-mentor {
  background: #10b981;
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 12px;
  font-size: 0.95rem;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  display: inline-flex;
  align-items: center;
  gap: 10px;
  text-decoration: none;
  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.25);
}

.btn-find-mentor:hover, .btn-find-new-mentor:hover {
  background: #059669;
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(16, 185, 129, 0.35);
}

.btn-find-mentor:active, .btn-find-new-mentor:active {
  transform: translateY(0);
}

</style>
{% endblock %}

